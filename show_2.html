<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Access-Control-Allow-Origin" content="*"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>NGO channel | Category</title>
    <!-- Bootstrap -->
    <link rel="stylesheet" type="text/css" href="asset/js/bootstrap/css/bootstrap.min.css" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="asset/css/style.css" />
    <link rel="stylesheet" href="show.css" />
    <style type="text/css">
    .intro {
        background-color: transparent;
    }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <h1>NPO Channel</h1>
            <div role="tabpanel">
                <div class="col-sm-3">
                    <h4><span class="glyphicon glyphicon-th-large" aria-hidden="true"></span> 團體類型</h4>
                    <hr class="tab-hr" />
                    <ul id="type" class="nav nav-pills brand-pills nav-stacked" role="tablist">
                        <li role="presentation" class="brand-nav active"><a id="first" href="#tab1" aria-controls="tab1" role="tab" data-toggle="tab" tag="全部">全部</a></li>
                        <li role="presentation" class="brand-nav"><a href="#tab1" aria-controls="tab1" role="tab" data-toggle="tab" tag="老人福利">老人福利</a></li>
                        <li role="presentation" class="brand-nav"><a href="#tab2" aria-controls="tab2" role="tab" data-toggle="tab" tag="身心障礙福利">身心障礙福利</a></li>
                        <li role="presentation" class="brand-nav"><a href="#tab3" aria-controls="tab3" role="tab" data-toggle="tab" tag="綜合性服務">綜合性服務</a></li>
                        <li role="presentation" class="brand-nav"><a href="#tab4" aria-controls="tab4" role="tab" data-toggle="tab" tag="兒童青少年福利">兒童青少年福利</a></li>
                        <li role="presentation" class="brand-nav"><a href="#tab5" aria-controls="tab5" role="tab" data-toggle="tab" tag="健康醫療">健康醫療</a></li>
                    </ul>
                    <h4><span class="glyphicon glyphicon-th" aria-hidden="true"></span> 捐贈項目</h4>
                    <hr class="tab-hr" />
                    <ul id="donate" class="nav nav-pills brand-pills nav-stacked green" role="tablist">
                        <li role="presentation" class="brand-nav active"><a href="#tab5" aria-controls="tab5" role="tab" data-toggle="tab" donate="全部">全部</a></li>
                        <li role="presentation" class="brand-nav"><a href="#tab5" aria-controls="tab5" role="tab" data-toggle="tab" donate="物資">物資</a></li>
                        <li role="presentation" class="brand-nav"><a href="#tab5" aria-controls="tab5" role="tab" data-toggle="tab" donate="捐款">捐款</a></li>
                        <li role="presentation" class="brand-nav"><a href="#tab5" aria-controls="tab5" role="tab" data-toggle="tab" donate="發票">發票</a></li>
                        <li role="presentation" class="brand-nav"><a href="#tab5" aria-controls="tab5" role="tab" data-toggle="tab" donate="志工">志工</a></li>
                        <li role="presentation" class="brand-nav"><a href="#tab5" aria-controls="tab5" role="tab" data-toggle="tab" donate="捐頭髮">捐頭髮</a></li>
                        <li role="presentation" class="brand-nav"><a href="#tab5" aria-controls="tab5" role="tab" data-toggle="tab" donate="捐紅利">捐紅利</a></li>
                    </ul>
                </div>
                <div class="col-sm-9">
                    <div class="tab-content">
                        <div role="tabpanel" class="tab-pane active" id="tab1">
                            <!--  <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">Panel title</h3>
                                </div>
                                <div class="panel-body">
                                    <p>Panel content</p>
                                    <span class="label label-primary">Primary Label</span>
                                    <span class="label label-success">Success Label</span>
                                    <span class="label label-info">Info Label</span>
                                    <span class="label label-warning">Warning Label</span>
                                    <span class="label label-danger">Danger Label</span>
                                </div>
                            </div>
                            <hr> -->
                        </div>
                        <div role="tabpanel" class="tab-pane" id="tab2">
                            <!--   <p>
                                Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. Hi mindless mortuis soulless creaturas, imo evil stalking monstra adventus resi dentevil vultus comedat cerebella viventium. Qui animated corpse, cricket bat max brucks terribilem incessu zomby.
                            </p>
                            <p>
                                The voodoo sacerdos flesh eater, suscitat mortuos comedere carnem virus. Zonbi tattered for solum oculi eorum defunctis go lum cerebro. Nescio brains an Undead zombies. Sicut malus putrid voodoo horror. Nigh tofth eliv ingdead.
                            </p> -->
                        </div>
                        <div role="tabpanel" class="tab-pane" id="tab3">
                            <!--   <p>
                                Lorem ipsizzle dolor away amizzle, consectetuer pizzle elizzle. Nullizzle yo velizzle, check it out volutpizzle, quis, gravida vel, yo. Ma nizzle eget tortor. Sizzle eros. My shizz izzle dolizzle gizzle turpis tempizzle fo shizzle mah nizzle fo rizzle, mah home g-dizzle. Maurizzle pellentesque nibh izzle own yo'. Check it out in tortor. Pellentesque fizzle rhoncizzle nisi.
                            </p>
                            <p>
                                In hac habitasse platea dictumst. Shizzlin dizzle dapibus. You son of a bizzle tellizzle urna, pretizzle fo shizzle mah nizzle fo rizzle, mah home g-dizzle, ghetto ac, check it out vitae, nunc. Shizzlin dizzle suscipizzle. Integizzle sempizzle velit sizzle dizzle.
                            </p> -->
                        </div>
                        <div role="tabpanel" class="tab-pane" id="tab4">
                            <!--    <p>
                                Collaboratively administrate empowered markets via plug-and-play networks. Dynamically procrastinate B2C users after installed base benefits. Dramatically visualize customer directed convergence without revolutionary ROI.
                            </p>
                            <p>
                                Efficiently unleash cross-media information without cross-media value. Quickly maximize timely deliverables for real-time schemas. Dramatically maintain clicks-and-mortar solutions without functional solutions.
                            </p>
                            <p>
                                Completely synergize resource sucking relationships via premier niche markets. Professionally cultivate one-to-one customer service with robust ideas. Dynamically innovate resource-leveling customer service for state of the art customer service.
                            </p> -->
                        </div>
                        <div role="tabpanel" class="tab-pane" id="tab5">
                            <!--    <p>
                                Collaboratively administrate empowered markets via plug-and-play networks. Dynamically procrastinate B2C users after installed base benefits. Dramatically visualize customer directed convergence without revolutionary ROI.
                            </p>
                            <p>
                                Efficiently unleash cross-media information without cross-media value. Quickly maximize timely deliverables for real-time schemas. Dramatically maintain clicks-and-mortar solutions without functional solutions.
                            </p>
                            <p>
                                Completely synergize resource sucking relationships via premier niche markets. Professionally cultivate one-to-one customer service with robust ideas. Dynamically innovate resource-leveling customer service for state of the art customer service.
                            </p> -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script type="text/javascript" src="asset/js/bootstrap/js/jquery-2.1.4.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script type="text/javascript" src="asset/js/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript">
    $(document).ready(function() {

        $(document).on('click', '.panel-default', function(event) {

            var id = $(this).attr('data-ref');
            window.location = 'show_detail.html?org_id=' + id;

        });


        // type
        $('#type .brand-nav a').unbind('click').bind('click', function() {

            console.log('type');

            var tag = $(this).attr('tag');
            var donate = $('#donate .brand-nav.active a').attr('donate');
            var controller = $(this).attr('aria-controls');
            var get_str = '';


            if (tag === '全部') {
                tag = '';
            } else {
                tag = 'type=' + tag;
            }

            if (donate === '全部') {
                donate = '';
            } else {
                donate = 'donate=' + donate;
            }

            if (tag === '' || donate === '') {
                get_str += tag + donate;
            } else {
                get_str += tag + '&' + donate;
            }

            console.warn(get_str);
            // return;
            getList(get_str, controller);
        });

        // donate
        $('#donate .brand-nav a').unbind('click').bind('click', function() {

            console.log('donate');

            var tag = $('#type .brand-nav.active a').attr('tag');
            var donate = $(this).attr('donate');
            var controller = $(this).attr('aria-controls');
            var get_str = '';


            if (tag === '全部') {
                tag = '';
            } else {
                tag = 'type=' + tag;
            }

            if (donate === '全部') {
                donate = '';
            } else {
                donate = 'donate=' + donate;
            }

            if (tag === '' || donate === '') {
                get_str += tag + donate;
            } else {
                get_str += tag + '&' + donate;
            }

            console.warn(get_str);
            getList(get_str, controller);
        });



        // init
        $("#first").trigger('click');

    });


    function getList(get_str, controller) {

        $.ajax({
            url: "https://www.bringoo.com.tw/npo_map/show_npo.php?" + get_str,
            type: "GET",
            success: function(res) {
                var json = JSON.parse(res);

                var i;
                var tmp = '';
                var id = '#' + controller;

                for (i = 0; i < json['list'].length; ++i) {

                    var choose = json['list'][i]['choose'];

                    if (choose===1) {

                        var myid = json['list'][i]['id'];
                        var name = json['list'][i]['name'];
                        var desc = json['list'][i]['desc'];

                        tmp += '<div class="panel panel-default" data-ref="' + myid + '">' +
                            '<div class="panel-heading">' +
                            '<h3 class="panel-title">' + name + '</h3>' +
                            '</div>' +
                            '<div class="panel-body">' +
                            '<p>' + desc + '</p>';

                        var type_length = json['list'][i]['type'].length;
                        var tag_arr = json['list'][i]['type'].concat(json['list'][i]['donate']);
                        var tags = '';
                        for (j=0; j<tag_arr.length; ++j) {

                            var color;
                            if (j!=0 && j>=type_length) {
                                color = 'label-success';
                            } else {
                                color = 'label-primary';
                            }

                            tags += '<span class="label ' +color+ '">' +tag_arr[j]+ '</span>&nbsp;';

                        }

                        tmp += tags+'</div></div><hr />';

                    }

                    //
                    $.ajax({
                      url: "https://www.bringoo.com.tw/npo_map/show_star_avg.php?org_id=" + json['list'][i]['id'],
                      type: 'get',
                      success: function(res){
                        console.log(res);
                      }
                    });

                }

                $(id).html(tmp);

            }
        });

    }
    </script>
</body>

</html>
